begin_unit|revision:1.0.0;language:Java;cregit-version:0.0.1
begin_comment
comment|/*****************************************************************  *   Licensed to the Apache Software Foundation (ASF) under one  *  or more contributor license agreements.  See the NOTICE file  *  distributed with this work for additional information  *  regarding copyright ownership.  The ASF licenses this file  *  to you under the Apache License, Version 2.0 (the  *  "License"); you may not use this file except in compliance  *  with the License.  You may obtain a copy of the License at  *  *    http://www.apache.org/licenses/LICENSE-2.0  *  *  Unless required by applicable law or agreed to in writing,  *  software distributed under the License is distributed on an  *  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY  *  KIND, either express or implied.  See the License for the  *  specific language governing permissions and limitations  *  under the License.  ****************************************************************/
end_comment

begin_package
package|package
name|org
operator|.
name|apache
operator|.
name|cayenne
operator|.
name|dba
package|;
end_package

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|Serializable
import|;
end_import

begin_import
import|import
name|java
operator|.
name|math
operator|.
name|BigInteger
import|;
end_import

begin_import
import|import
name|java
operator|.
name|sql
operator|.
name|DatabaseMetaData
import|;
end_import

begin_import
import|import
name|java
operator|.
name|sql
operator|.
name|ResultSet
import|;
end_import

begin_import
import|import
name|java
operator|.
name|sql
operator|.
name|SQLException
import|;
end_import

begin_import
import|import
name|java
operator|.
name|sql
operator|.
name|Types
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Calendar
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashMap
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Map
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|cayenne
operator|.
name|util
operator|.
name|Util
import|;
end_import

begin_comment
comment|/**  * A utility class that handles mappings of JDBC data types to the database types and Java  * types. Also contains methods that provide information about JDBC types.  *   */
end_comment

begin_class
specifier|public
class|class
name|TypesMapping
block|{
comment|// Never use "-1" or any other normal integer, since there
comment|// is a big chance it is being reserved in java.sql.Types
specifier|public
specifier|static
specifier|final
name|int
name|NOT_DEFINED
init|=
name|Integer
operator|.
name|MAX_VALUE
decl_stmt|;
comment|// char constants for the sql data types
specifier|public
specifier|static
specifier|final
name|String
name|SQL_ARRAY
init|=
literal|"ARRAY"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_BIGINT
init|=
literal|"BIGINT"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_BINARY
init|=
literal|"BINARY"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_BIT
init|=
literal|"BIT"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_BLOB
init|=
literal|"BLOB"
decl_stmt|;
comment|/**      * @since 1.2      */
specifier|public
specifier|static
specifier|final
name|String
name|SQL_BOOLEAN
init|=
literal|"BOOLEAN"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_CLOB
init|=
literal|"CLOB"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_CHAR
init|=
literal|"CHAR"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_DATE
init|=
literal|"DATE"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_DECIMAL
init|=
literal|"DECIMAL"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_DOUBLE
init|=
literal|"DOUBLE"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_FLOAT
init|=
literal|"FLOAT"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_INTEGER
init|=
literal|"INTEGER"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_LONGVARCHAR
init|=
literal|"LONGVARCHAR"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_LONGVARBINARY
init|=
literal|"LONGVARBINARY"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_NUMERIC
init|=
literal|"NUMERIC"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_REAL
init|=
literal|"REAL"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_SMALLINT
init|=
literal|"SMALLINT"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_TINYINT
init|=
literal|"TINYINT"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_TIME
init|=
literal|"TIME"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_TIMESTAMP
init|=
literal|"TIMESTAMP"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_VARBINARY
init|=
literal|"VARBINARY"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_VARCHAR
init|=
literal|"VARCHAR"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SQL_OTHER
init|=
literal|"OTHER"
decl_stmt|;
comment|// char constants for Java data types
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_LONG
init|=
literal|"java.lang.Long"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_BYTES
init|=
literal|"byte[]"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_BOOLEAN
init|=
literal|"java.lang.Boolean"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_STRING
init|=
literal|"java.lang.String"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_SQLDATE
init|=
literal|"java.sql.Date"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_UTILDATE
init|=
literal|"java.util.Date"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_BIGDECIMAL
init|=
literal|"java.math.BigDecimal"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_DOUBLE
init|=
literal|"java.lang.Double"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_FLOAT
init|=
literal|"java.lang.Float"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_INTEGER
init|=
literal|"java.lang.Integer"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_SHORT
init|=
literal|"java.lang.Short"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_BYTE
init|=
literal|"java.lang.Byte"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_TIME
init|=
literal|"java.sql.Time"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_TIMESTAMP
init|=
literal|"java.sql.Timestamp"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|JAVA_BLOB
init|=
literal|"java.sql.Blob"
decl_stmt|;
comment|/**      * Keys: SQL string type names, Values: SQL int type definitions from java.sql.Types      */
specifier|private
specifier|static
specifier|final
name|Map
argument_list|<
name|String
argument_list|,
name|Integer
argument_list|>
name|sqlStringType
init|=
operator|new
name|HashMap
argument_list|<
name|String
argument_list|,
name|Integer
argument_list|>
argument_list|()
decl_stmt|;
comment|/**      * Keys: SQL int type definitions from java.sql.Types, Values: SQL string type names      */
specifier|private
specifier|static
specifier|final
name|Map
argument_list|<
name|Integer
argument_list|,
name|String
argument_list|>
name|sqlEnumType
init|=
operator|new
name|HashMap
argument_list|<
name|Integer
argument_list|,
name|String
argument_list|>
argument_list|()
decl_stmt|;
comment|/**      * Keys: SQL int type definitions from java.sql.Types, Values: java class names      */
specifier|private
specifier|static
specifier|final
name|Map
argument_list|<
name|Integer
argument_list|,
name|String
argument_list|>
name|sqlEnumJava
init|=
operator|new
name|HashMap
argument_list|<
name|Integer
argument_list|,
name|String
argument_list|>
argument_list|()
decl_stmt|;
comment|/**      * Keys: java class names, Values: SQL int type definitions from java.sql.Types      */
specifier|private
specifier|static
specifier|final
name|Map
argument_list|<
name|String
argument_list|,
name|Integer
argument_list|>
name|javaSqlEnum
init|=
operator|new
name|HashMap
argument_list|<
name|String
argument_list|,
name|Integer
argument_list|>
argument_list|()
decl_stmt|;
static|static
block|{
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_ARRAY
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|ARRAY
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_BIGINT
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIGINT
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_BINARY
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BINARY
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_BIT
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIT
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_BLOB
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BLOB
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_BOOLEAN
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BOOLEAN
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_CLOB
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|CLOB
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_CHAR
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|CHAR
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_DATE
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DATE
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_DECIMAL
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DECIMAL
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_DOUBLE
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DOUBLE
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_FLOAT
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|FLOAT
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_INTEGER
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|INTEGER
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_LONGVARCHAR
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|LONGVARCHAR
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_LONGVARBINARY
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|LONGVARBINARY
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_NUMERIC
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|NUMERIC
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_REAL
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|REAL
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_SMALLINT
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|SMALLINT
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_TINYINT
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TINYINT
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_TIME
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIME
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_TIMESTAMP
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIMESTAMP
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_VARBINARY
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|VARBINARY
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_VARCHAR
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|VARCHAR
argument_list|)
argument_list|)
expr_stmt|;
name|sqlStringType
operator|.
name|put
argument_list|(
name|SQL_OTHER
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|OTHER
argument_list|)
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|ARRAY
argument_list|)
argument_list|,
name|SQL_ARRAY
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIGINT
argument_list|)
argument_list|,
name|SQL_BIGINT
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BINARY
argument_list|)
argument_list|,
name|SQL_BINARY
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIT
argument_list|)
argument_list|,
name|SQL_BIT
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BOOLEAN
argument_list|)
argument_list|,
name|SQL_BOOLEAN
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BLOB
argument_list|)
argument_list|,
name|SQL_BLOB
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|CLOB
argument_list|)
argument_list|,
name|SQL_CLOB
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|CHAR
argument_list|)
argument_list|,
name|SQL_CHAR
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DATE
argument_list|)
argument_list|,
name|SQL_DATE
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DECIMAL
argument_list|)
argument_list|,
name|SQL_DECIMAL
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DOUBLE
argument_list|)
argument_list|,
name|SQL_DOUBLE
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|FLOAT
argument_list|)
argument_list|,
name|SQL_FLOAT
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|INTEGER
argument_list|)
argument_list|,
name|SQL_INTEGER
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|LONGVARCHAR
argument_list|)
argument_list|,
name|SQL_LONGVARCHAR
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|LONGVARBINARY
argument_list|)
argument_list|,
name|SQL_LONGVARBINARY
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|NUMERIC
argument_list|)
argument_list|,
name|SQL_NUMERIC
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|REAL
argument_list|)
argument_list|,
name|SQL_REAL
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|SMALLINT
argument_list|)
argument_list|,
name|SQL_SMALLINT
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TINYINT
argument_list|)
argument_list|,
name|SQL_TINYINT
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIME
argument_list|)
argument_list|,
name|SQL_TIME
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIMESTAMP
argument_list|)
argument_list|,
name|SQL_TIMESTAMP
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|VARBINARY
argument_list|)
argument_list|,
name|SQL_VARBINARY
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|VARCHAR
argument_list|)
argument_list|,
name|SQL_VARCHAR
argument_list|)
expr_stmt|;
name|sqlEnumType
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|OTHER
argument_list|)
argument_list|,
name|SQL_OTHER
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIGINT
argument_list|)
argument_list|,
name|JAVA_LONG
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BINARY
argument_list|)
argument_list|,
name|JAVA_BYTES
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIT
argument_list|)
argument_list|,
name|JAVA_BOOLEAN
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BOOLEAN
argument_list|)
argument_list|,
name|JAVA_BOOLEAN
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BLOB
argument_list|)
argument_list|,
name|JAVA_BYTES
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|CLOB
argument_list|)
argument_list|,
name|JAVA_STRING
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|CHAR
argument_list|)
argument_list|,
name|JAVA_STRING
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DATE
argument_list|)
argument_list|,
name|JAVA_UTILDATE
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DECIMAL
argument_list|)
argument_list|,
name|JAVA_BIGDECIMAL
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DOUBLE
argument_list|)
argument_list|,
name|JAVA_DOUBLE
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|FLOAT
argument_list|)
argument_list|,
name|JAVA_FLOAT
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|INTEGER
argument_list|)
argument_list|,
name|JAVA_INTEGER
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|LONGVARCHAR
argument_list|)
argument_list|,
name|JAVA_STRING
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|LONGVARBINARY
argument_list|)
argument_list|,
name|JAVA_BYTES
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|NUMERIC
argument_list|)
argument_list|,
name|JAVA_BIGDECIMAL
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|REAL
argument_list|)
argument_list|,
name|JAVA_FLOAT
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|SMALLINT
argument_list|)
argument_list|,
name|JAVA_SHORT
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TINYINT
argument_list|)
argument_list|,
name|JAVA_BYTE
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIME
argument_list|)
argument_list|,
name|JAVA_UTILDATE
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIMESTAMP
argument_list|)
argument_list|,
name|JAVA_UTILDATE
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|VARBINARY
argument_list|)
argument_list|,
name|JAVA_BYTES
argument_list|)
expr_stmt|;
name|sqlEnumJava
operator|.
name|put
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|VARCHAR
argument_list|)
argument_list|,
name|JAVA_STRING
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_LONG
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIGINT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_BYTES
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BINARY
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_BOOLEAN
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_STRING
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|VARCHAR
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_SQLDATE
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DATE
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_UTILDATE
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DATE
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_TIMESTAMP
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIMESTAMP
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_BIGDECIMAL
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DECIMAL
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_DOUBLE
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DOUBLE
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_FLOAT
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|FLOAT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_INTEGER
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|INTEGER
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_SHORT
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|SMALLINT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_BYTE
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TINYINT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_TIME
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIME
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
name|JAVA_TIMESTAMP
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIMESTAMP
argument_list|)
argument_list|)
expr_stmt|;
comment|// add primitives
name|javaSqlEnum
operator|.
name|put
argument_list|(
literal|"byte"
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TINYINT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
literal|"int"
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|INTEGER
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
literal|"short"
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|SMALLINT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
literal|"char"
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|CHAR
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
literal|"double"
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DOUBLE
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
literal|"long"
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIGINT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
literal|"float"
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|FLOAT
argument_list|)
argument_list|)
expr_stmt|;
name|javaSqlEnum
operator|.
name|put
argument_list|(
literal|"boolean"
argument_list|,
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BIT
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|/**      * Returns true if supplied type can have a length attribute as a part of column      * definition.      */
specifier|public
specifier|static
name|boolean
name|supportsLength
parameter_list|(
name|int
name|type
parameter_list|)
block|{
return|return
name|type
operator|==
name|Types
operator|.
name|BINARY
operator|||
name|type
operator|==
name|Types
operator|.
name|CHAR
operator|||
name|type
operator|==
name|Types
operator|.
name|DECIMAL
operator|||
name|type
operator|==
name|Types
operator|.
name|DOUBLE
operator|||
name|type
operator|==
name|Types
operator|.
name|FLOAT
operator|||
name|type
operator|==
name|Types
operator|.
name|NUMERIC
operator|||
name|type
operator|==
name|Types
operator|.
name|REAL
operator|||
name|type
operator|==
name|Types
operator|.
name|VARBINARY
operator|||
name|type
operator|==
name|Types
operator|.
name|VARCHAR
return|;
block|}
comment|/**      * Returns true if supplied type is a numeric type.      */
specifier|public
specifier|static
name|boolean
name|isNumeric
parameter_list|(
name|int
name|type
parameter_list|)
block|{
return|return
name|type
operator|==
name|Types
operator|.
name|BIGINT
operator|||
name|type
operator|==
name|Types
operator|.
name|BIT
operator|||
name|type
operator|==
name|Types
operator|.
name|DECIMAL
operator|||
name|type
operator|==
name|Types
operator|.
name|DOUBLE
operator|||
name|type
operator|==
name|Types
operator|.
name|FLOAT
operator|||
name|type
operator|==
name|Types
operator|.
name|INTEGER
operator|||
name|type
operator|==
name|Types
operator|.
name|NUMERIC
operator|||
name|type
operator|==
name|Types
operator|.
name|REAL
operator|||
name|type
operator|==
name|Types
operator|.
name|SMALLINT
operator|||
name|type
operator|==
name|Types
operator|.
name|TINYINT
return|;
block|}
comment|/**      * Returns true if supplied type is a decimal type.      */
specifier|public
specifier|static
name|boolean
name|isDecimal
parameter_list|(
name|int
name|type
parameter_list|)
block|{
return|return
name|type
operator|==
name|Types
operator|.
name|DECIMAL
operator|||
name|type
operator|==
name|Types
operator|.
name|DOUBLE
operator|||
name|type
operator|==
name|Types
operator|.
name|FLOAT
operator|||
name|type
operator|==
name|Types
operator|.
name|REAL
operator|||
name|type
operator|==
name|Types
operator|.
name|NUMERIC
return|;
block|}
comment|/** Returns an array of string names of the default JDBC data types. */
specifier|public
specifier|static
name|String
index|[]
name|getDatabaseTypes
parameter_list|()
block|{
return|return
name|sqlStringType
operator|.
name|keySet
argument_list|()
operator|.
name|toArray
argument_list|(
operator|new
name|String
index|[
literal|0
index|]
argument_list|)
return|;
block|}
comment|/**      * Method implements an algorithm to pick a data type from a list of alternatives that      * most closely matches JDBC data type.      */
specifier|protected
specifier|static
name|String
name|pickDataType
parameter_list|(
name|int
name|jdbcType
parameter_list|,
name|TypeInfo
index|[]
name|alts
parameter_list|)
block|{
name|int
name|len
init|=
name|alts
operator|.
name|length
decl_stmt|;
if|if
condition|(
name|len
operator|==
literal|0
condition|)
return|return
literal|null
return|;
if|if
condition|(
name|len
operator|==
literal|1
condition|)
return|return
name|alts
index|[
literal|0
index|]
operator|.
name|name
return|;
comment|// now the fun starts.. try to guess the right type
name|String
name|jdbcName
init|=
name|getSqlNameByType
argument_list|(
name|jdbcType
argument_list|)
operator|.
name|toUpperCase
argument_list|()
decl_stmt|;
comment|// 1. exact match
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|jdbcName
operator|.
name|equalsIgnoreCase
argument_list|(
name|alts
index|[
name|i
index|]
operator|.
name|name
argument_list|)
condition|)
return|return
name|alts
index|[
name|i
index|]
operator|.
name|name
return|;
block|}
comment|// 2. filter those with biggest precision
name|long
name|maxPrec
init|=
literal|0
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|maxPrec
operator|<
name|alts
index|[
name|i
index|]
operator|.
name|precision
condition|)
block|{
name|maxPrec
operator|=
name|alts
index|[
name|i
index|]
operator|.
name|precision
expr_stmt|;
block|}
block|}
name|List
argument_list|<
name|TypeInfo
argument_list|>
name|list
init|=
operator|new
name|ArrayList
argument_list|<
name|TypeInfo
argument_list|>
argument_list|()
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|maxPrec
operator|==
name|alts
index|[
name|i
index|]
operator|.
name|precision
condition|)
block|{
name|list
operator|.
name|add
argument_list|(
name|alts
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
block|}
comment|// work with smaller list now.....
name|int
name|slen
init|=
name|list
operator|.
name|size
argument_list|()
decl_stmt|;
if|if
condition|(
name|slen
operator|==
literal|1
condition|)
return|return
operator|(
name|list
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|name
return|;
comment|// start/end match
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|slen
condition|;
name|i
operator|++
control|)
block|{
name|String
name|uppercase
init|=
operator|(
name|list
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|)
operator|.
name|name
operator|.
name|toUpperCase
argument_list|()
decl_stmt|;
if|if
condition|(
name|uppercase
operator|.
name|startsWith
argument_list|(
name|jdbcName
argument_list|)
operator|||
name|uppercase
operator|.
name|endsWith
argument_list|(
name|jdbcName
argument_list|)
condition|)
return|return
operator|(
name|list
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|)
operator|.
name|name
return|;
block|}
comment|// in the middle match
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|slen
condition|;
name|i
operator|++
control|)
block|{
name|String
name|uppercase
init|=
operator|(
name|list
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|)
operator|.
name|name
operator|.
name|toUpperCase
argument_list|()
decl_stmt|;
if|if
condition|(
name|uppercase
operator|.
name|contains
argument_list|(
name|jdbcName
argument_list|)
condition|)
return|return
operator|(
name|list
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|)
operator|.
name|name
return|;
block|}
comment|// out of ideas... return the first one
return|return
operator|(
name|list
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|name
return|;
block|}
comment|/**      * Returns a JDBC int type for SQL typem name.      */
specifier|public
specifier|static
name|int
name|getSqlTypeByName
parameter_list|(
name|String
name|typeName
parameter_list|)
block|{
name|Integer
name|tmp
init|=
name|sqlStringType
operator|.
name|get
argument_list|(
name|typeName
argument_list|)
decl_stmt|;
return|return
operator|(
literal|null
operator|==
name|tmp
operator|)
condition|?
name|NOT_DEFINED
else|:
name|tmp
operator|.
name|intValue
argument_list|()
return|;
block|}
comment|/**      * Returns a String representation of the SQL type from its JDBC code.      */
specifier|public
specifier|static
name|String
name|getSqlNameByType
parameter_list|(
name|int
name|type
parameter_list|)
block|{
return|return
name|sqlEnumType
operator|.
name|get
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|type
argument_list|)
argument_list|)
return|;
block|}
comment|/**      * Returns default java.sql.Types type by the Java type name.      *       * @param className Fully qualified Java Class name.      * @return The SQL type or NOT_DEFINED if no type found.      */
specifier|public
specifier|static
name|int
name|getSqlTypeByJava
parameter_list|(
name|String
name|className
parameter_list|)
block|{
if|if
condition|(
name|className
operator|==
literal|null
condition|)
block|{
return|return
name|NOT_DEFINED
return|;
block|}
name|Integer
name|type
init|=
name|javaSqlEnum
operator|.
name|get
argument_list|(
name|className
argument_list|)
decl_stmt|;
if|if
condition|(
name|type
operator|!=
literal|null
condition|)
block|{
return|return
name|type
operator|.
name|intValue
argument_list|()
return|;
block|}
comment|// try to load a Java class - some nonstandard mappings may work
name|Class
argument_list|<
name|?
argument_list|>
name|aClass
decl_stmt|;
try|try
block|{
name|aClass
operator|=
name|Util
operator|.
name|getJavaClass
argument_list|(
name|className
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Throwable
name|th
parameter_list|)
block|{
return|return
name|NOT_DEFINED
return|;
block|}
return|return
name|getSqlTypeByJava
argument_list|(
name|aClass
argument_list|)
return|;
block|}
comment|/**      * Guesses a default JDBC type for the Java class.      *       * @since 1.1      */
specifier|public
specifier|static
name|int
name|getSqlTypeByJava
parameter_list|(
name|Class
argument_list|<
name|?
argument_list|>
name|javaClass
parameter_list|)
block|{
if|if
condition|(
name|javaClass
operator|==
literal|null
condition|)
block|{
return|return
name|NOT_DEFINED
return|;
block|}
comment|// check standard mapping of class and superclasses
name|Class
argument_list|<
name|?
argument_list|>
name|aClass
init|=
name|javaClass
decl_stmt|;
while|while
condition|(
name|aClass
operator|!=
literal|null
condition|)
block|{
name|String
name|name
decl_stmt|;
if|if
condition|(
name|aClass
operator|.
name|isArray
argument_list|()
condition|)
block|{
name|name
operator|=
name|aClass
operator|.
name|getComponentType
argument_list|()
operator|.
name|getName
argument_list|()
operator|+
literal|"[]"
expr_stmt|;
block|}
else|else
block|{
name|name
operator|=
name|aClass
operator|.
name|getName
argument_list|()
expr_stmt|;
block|}
name|Object
name|type
init|=
name|javaSqlEnum
operator|.
name|get
argument_list|(
name|name
argument_list|)
decl_stmt|;
if|if
condition|(
name|type
operator|!=
literal|null
condition|)
block|{
return|return
operator|(
operator|(
name|Number
operator|)
name|type
operator|)
operator|.
name|intValue
argument_list|()
return|;
block|}
name|aClass
operator|=
name|aClass
operator|.
name|getSuperclass
argument_list|()
expr_stmt|;
block|}
comment|// check non-standard JDBC types that are still supported by JPA
if|if
condition|(
name|javaClass
operator|.
name|isArray
argument_list|()
condition|)
block|{
name|Class
argument_list|<
name|?
argument_list|>
name|elementType
init|=
name|javaClass
operator|.
name|getComponentType
argument_list|()
decl_stmt|;
if|if
condition|(
name|Character
operator|.
name|class
operator|.
name|isAssignableFrom
argument_list|(
name|elementType
argument_list|)
operator|||
name|Character
operator|.
name|TYPE
operator|.
name|isAssignableFrom
argument_list|(
name|elementType
argument_list|)
condition|)
block|{
return|return
name|Types
operator|.
name|VARCHAR
return|;
block|}
if|else if
condition|(
name|Byte
operator|.
name|class
operator|.
name|isAssignableFrom
argument_list|(
name|elementType
argument_list|)
operator|||
name|Byte
operator|.
name|TYPE
operator|.
name|isAssignableFrom
argument_list|(
name|elementType
argument_list|)
condition|)
block|{
return|return
name|Types
operator|.
name|VARBINARY
return|;
block|}
block|}
if|if
condition|(
name|Calendar
operator|.
name|class
operator|.
name|isAssignableFrom
argument_list|(
name|javaClass
argument_list|)
condition|)
block|{
return|return
name|Types
operator|.
name|TIMESTAMP
return|;
block|}
if|else if
condition|(
name|BigInteger
operator|.
name|class
operator|.
name|isAssignableFrom
argument_list|(
name|javaClass
argument_list|)
condition|)
block|{
return|return
name|Types
operator|.
name|BIGINT
return|;
block|}
comment|// serializable check should be the last one when all other mapping attempts
comment|// failed
if|else if
condition|(
name|Serializable
operator|.
name|class
operator|.
name|isAssignableFrom
argument_list|(
name|javaClass
argument_list|)
condition|)
block|{
return|return
name|Types
operator|.
name|VARBINARY
return|;
block|}
return|return
name|NOT_DEFINED
return|;
block|}
comment|/**      * Get the corresponding Java type by its java.sql.Types counterpart. Note that this      * method should be used as a last resort, with explicit mapping provided by user used      * as a first choice, as it can only guess how to map certain types, such as NUMERIC,      * etc.      *       * @return Fully qualified Java type name or null if not found.      */
specifier|public
specifier|static
name|String
name|getJavaBySqlType
parameter_list|(
name|int
name|type
parameter_list|)
block|{
return|return
name|sqlEnumJava
operator|.
name|get
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|type
argument_list|)
argument_list|)
return|;
block|}
comment|/**      * Get the corresponding Java type by its java.sql.Types counterpart. Note that this      * method should be used as a last resort, with explicit mapping provided by user used      * as a first choice, as it can only guess how to map certain types, such as NUMERIC,      * etc.      *       * @return Fully qualified Java type name or null if not found.      */
specifier|public
specifier|static
name|String
name|getJavaBySqlType
parameter_list|(
name|int
name|type
parameter_list|,
name|int
name|length
parameter_list|,
name|int
name|scale
parameter_list|)
block|{
comment|// this does not always produce the correct result. See for instance CAY-1052 - PG
comment|// drivers from 8.2 and newer decided that the scale of "0" means "undefined", not
comment|// really zero.
if|if
condition|(
name|type
operator|==
name|Types
operator|.
name|NUMERIC
operator|&&
name|scale
operator|==
literal|0
condition|)
block|{
name|type
operator|=
name|Types
operator|.
name|INTEGER
expr_stmt|;
block|}
return|return
name|sqlEnumJava
operator|.
name|get
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|type
argument_list|)
argument_list|)
return|;
block|}
specifier|protected
name|Map
argument_list|<
name|Integer
argument_list|,
name|List
argument_list|<
name|TypeInfo
argument_list|>
argument_list|>
name|databaseTypes
init|=
operator|new
name|HashMap
argument_list|<
name|Integer
argument_list|,
name|List
argument_list|<
name|TypeInfo
argument_list|>
argument_list|>
argument_list|()
decl_stmt|;
specifier|public
name|TypesMapping
parameter_list|(
name|DatabaseMetaData
name|metaData
parameter_list|)
throws|throws
name|SQLException
block|{
comment|// map database types to standard JDBC types
name|ResultSet
name|rs
init|=
name|metaData
operator|.
name|getTypeInfo
argument_list|()
decl_stmt|;
try|try
block|{
while|while
condition|(
name|rs
operator|.
name|next
argument_list|()
condition|)
block|{
name|TypeInfo
name|info
init|=
operator|new
name|TypeInfo
argument_list|()
decl_stmt|;
name|info
operator|.
name|name
operator|=
name|rs
operator|.
name|getString
argument_list|(
literal|"TYPE_NAME"
argument_list|)
expr_stmt|;
name|info
operator|.
name|jdbcType
operator|=
name|rs
operator|.
name|getInt
argument_list|(
literal|"DATA_TYPE"
argument_list|)
expr_stmt|;
name|info
operator|.
name|precision
operator|=
name|rs
operator|.
name|getLong
argument_list|(
literal|"PRECISION"
argument_list|)
expr_stmt|;
name|Integer
name|key
init|=
name|Integer
operator|.
name|valueOf
argument_list|(
name|info
operator|.
name|jdbcType
argument_list|)
decl_stmt|;
name|List
argument_list|<
name|TypeInfo
argument_list|>
name|infos
init|=
name|databaseTypes
operator|.
name|get
argument_list|(
name|key
argument_list|)
decl_stmt|;
if|if
condition|(
name|infos
operator|==
literal|null
condition|)
block|{
name|infos
operator|=
operator|new
name|ArrayList
argument_list|<
name|TypeInfo
argument_list|>
argument_list|()
expr_stmt|;
name|databaseTypes
operator|.
name|put
argument_list|(
name|key
argument_list|,
name|infos
argument_list|)
expr_stmt|;
block|}
name|infos
operator|.
name|add
argument_list|(
name|info
argument_list|)
expr_stmt|;
block|}
block|}
finally|finally
block|{
name|rs
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
comment|// do some tricks to substitute for missing datatypes
comment|// 1. swap TIMESTAMP - DATE
name|Integer
name|ts
init|=
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|TIMESTAMP
argument_list|)
decl_stmt|;
name|Integer
name|dt
init|=
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|DATE
argument_list|)
decl_stmt|;
name|List
argument_list|<
name|TypeInfo
argument_list|>
name|tsInfo
init|=
name|databaseTypes
operator|.
name|get
argument_list|(
name|ts
argument_list|)
decl_stmt|;
name|List
argument_list|<
name|TypeInfo
argument_list|>
name|dtInfo
init|=
name|databaseTypes
operator|.
name|get
argument_list|(
name|dt
argument_list|)
decl_stmt|;
if|if
condition|(
name|tsInfo
operator|!=
literal|null
operator|&&
name|dtInfo
operator|==
literal|null
condition|)
name|databaseTypes
operator|.
name|put
argument_list|(
name|dt
argument_list|,
name|tsInfo
argument_list|)
expr_stmt|;
if|if
condition|(
name|dtInfo
operator|!=
literal|null
operator|&&
name|tsInfo
operator|==
literal|null
condition|)
name|databaseTypes
operator|.
name|put
argument_list|(
name|ts
argument_list|,
name|dtInfo
argument_list|)
expr_stmt|;
comment|// 2. Swap CLOB - LONGVARCHAR
name|Integer
name|clob
init|=
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|CLOB
argument_list|)
decl_stmt|;
name|Integer
name|lvc
init|=
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|LONGVARCHAR
argument_list|)
decl_stmt|;
name|List
argument_list|<
name|TypeInfo
argument_list|>
name|clobInfo
init|=
name|databaseTypes
operator|.
name|get
argument_list|(
name|clob
argument_list|)
decl_stmt|;
name|List
argument_list|<
name|TypeInfo
argument_list|>
name|lvcInfo
init|=
name|databaseTypes
operator|.
name|get
argument_list|(
name|lvc
argument_list|)
decl_stmt|;
if|if
condition|(
name|clobInfo
operator|!=
literal|null
operator|&&
name|lvcInfo
operator|==
literal|null
condition|)
name|databaseTypes
operator|.
name|put
argument_list|(
name|lvc
argument_list|,
name|clobInfo
argument_list|)
expr_stmt|;
if|if
condition|(
name|lvcInfo
operator|!=
literal|null
operator|&&
name|clobInfo
operator|==
literal|null
condition|)
name|databaseTypes
operator|.
name|put
argument_list|(
name|clob
argument_list|,
name|lvcInfo
argument_list|)
expr_stmt|;
comment|// 2. Swap BLOB - LONGVARBINARY
name|Integer
name|blob
init|=
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|BLOB
argument_list|)
decl_stmt|;
name|Integer
name|lvb
init|=
name|Integer
operator|.
name|valueOf
argument_list|(
name|Types
operator|.
name|LONGVARBINARY
argument_list|)
decl_stmt|;
name|List
argument_list|<
name|TypeInfo
argument_list|>
name|blobInfo
init|=
name|databaseTypes
operator|.
name|get
argument_list|(
name|blob
argument_list|)
decl_stmt|;
name|List
argument_list|<
name|TypeInfo
argument_list|>
name|lvbInfo
init|=
name|databaseTypes
operator|.
name|get
argument_list|(
name|lvb
argument_list|)
decl_stmt|;
if|if
condition|(
name|blobInfo
operator|!=
literal|null
operator|&&
name|lvbInfo
operator|==
literal|null
condition|)
name|databaseTypes
operator|.
name|put
argument_list|(
name|lvb
argument_list|,
name|blobInfo
argument_list|)
expr_stmt|;
if|if
condition|(
name|lvbInfo
operator|!=
literal|null
operator|&&
name|blobInfo
operator|==
literal|null
condition|)
name|databaseTypes
operator|.
name|put
argument_list|(
name|blob
argument_list|,
name|lvbInfo
argument_list|)
expr_stmt|;
block|}
comment|/** Stores (incomplete) information about database data type */
specifier|static
class|class
name|TypeInfo
block|{
name|String
name|name
decl_stmt|;
name|int
name|jdbcType
decl_stmt|;
name|long
name|precision
decl_stmt|;
annotation|@
name|Override
specifier|public
name|String
name|toString
parameter_list|()
block|{
name|StringBuilder
name|buf
init|=
operator|new
name|StringBuilder
argument_list|()
decl_stmt|;
name|buf
operator|.
name|append
argument_list|(
literal|"[   TypeInfo: "
argument_list|)
operator|.
name|append
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|buf
operator|.
name|append
argument_list|(
literal|"\n    JDBC Type: "
argument_list|)
operator|.
name|append
argument_list|(
name|TypesMapping
operator|.
name|getSqlNameByType
argument_list|(
name|jdbcType
argument_list|)
argument_list|)
expr_stmt|;
name|buf
operator|.
name|append
argument_list|(
literal|"\n    Precision: "
argument_list|)
operator|.
name|append
argument_list|(
name|precision
argument_list|)
expr_stmt|;
name|buf
operator|.
name|append
argument_list|(
literal|"\n]"
argument_list|)
expr_stmt|;
return|return
name|buf
operator|.
name|toString
argument_list|()
return|;
block|}
block|}
block|}
end_class

end_unit

